var documenterSearchIndex = {"docs":
[{"location":"communication/#Communication-1","page":"Communication","title":"Communication between Julia and Javascript","text":"","category":"section"},{"location":"communication/#","page":"Communication","title":"Communication","text":"After creating a Window and loading HTML and JS, you may want to interact with julia code (e.g. by clicking a button in HTML, or displaying a plot from julia).","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"This section covers this two-way communication.","category":"page"},{"location":"communication/#Julia-to-Javascript-1","page":"Communication","title":"Julia to Javascript","text":"","category":"section"},{"location":"communication/#","page":"Communication","title":"Communication","text":"using Blink\nwin = Window(Dict(:show=>false), async=false)","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"The easiest way to communicate to javascript from julia is with the @js and @js_ macros. These macros allow you to execute arbitrary javascript code in a given Window.","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"@js win x = 5;\n@js win x","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"The @js_ macro executes its code asynchronously, but doesn't return its result:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"@time @js win begin   # Blocks until finished; `i` is returned\n  for i in 0:1000000 end  # waste time\n  i  # return i\nend\n\n@time @js_ win begin   # Returns immediately, but `i` is not returned.\n  for i in 0:1000000 end  # waste time\n  i  # This is ignored\nend","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"If your javascript expression is complex, or you want to copy-paste existing javascript, it can be easier to represent it as a pure javascript string. For that, you can call the js function with a JSString:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"body!(win, \"\"\"<div id=\"box\" style=\"color:red;\"></div>\"\"\", async=false);\ndiv_id = \"box\";\njs(win, Blink.JSString(\"\"\"document.getElementById(\"$div_id\").style.color\"\"\"))","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Note that the code passed to these macros runs in its own scope, so any javascript variables you create with var (or the @var equivalent for @js) will be inaccessible after returning:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"@js win (@var x_var = 5; x_var)  # x_var is only accessible within this scope.\n@js win x_var","category":"page"},{"location":"communication/#Javascript-to-Julia-1","page":"Communication","title":"Javascript to Julia","text":"","category":"section"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Communication from javascript to julia currently works via a message passing interface.","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"To invoke julia code from javascript, you specify a julia callback via handle:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"julia> handle(w, \"press\") do args\n         @show args\n       end","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"This callback can then be triggered from javscript via Blink.msg():","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"using Blink\nw = Window(Dict(:show=>false), async=false)\nhandle(w, \"press\") do args\n  @show args\nend","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"@js w Blink.msg(\"press\", \"Hello from JS\");","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Note that the javascript function Blink.msg takes exactly 1 argument.  To pass more or fewer arguments, pass your arguments as an array:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"handle(w, \"event\") do count, values, message\n  # ...\nend\n@js w Blink.msg(\"event\", [1, ['a','b'], \"Hi\"]);","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Finally, here is an example that uses a button to call back to julia:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"using Blink\nw = Window(Dict(:show=>false), async=false)","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"handle(w, \"press\") do arg\n  println(arg)\nend\nbody!(w, \"\"\"<button onclick='Blink.msg(\"press\", \"HELLO\")'>go</button>\"\"\", async=false);","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Now, clicking the button will print HELLO to julia's STDOUT.","category":"page"},{"location":"communication/#Back-and-forth-1","page":"Communication","title":"Back-and-forth","text":"","category":"section"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Note that you cannot make a synchronous call to javascript from within a julia callback, or you'll cause julia to hang:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"BAD:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"julia> @js w x = 5\n\njulia> handle(w, \"press\") do args...\n         # Increment x and get its new value\n         x = @js w (x += 1; x)  # ERROR: Cannot make synchronous calls within a callback.\n         println(\"New value: $x\")\n       end\n#9 (generic function with 1 method)\n\njulia> @js w Blink.msg(\"press\", [])\n\n# JULIA HANGS UNTIL CTRL-C, WHICH KILLS YOUR BLINK WINDOW.","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"GOOD: Instead, if you need to access the value of x, you should simply provide it when invoking the press handler:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"@js w x = 5\n\nhandle(w, \"press\") do args...\n  x = args[1]\n  # Increment x\n  @js_ w (x = $x + 1)  # Note the _asynchronous_ call.\n  println(\"New value: $x\")\nend\n\n@js w Blink.msg(\"press\", x)\n# JULIA HANGS UNTIL CTRL-C, WHICH KILLS YOUR BLINK WINDOW.","category":"page"},{"location":"communication/#Tasks-1","page":"Communication","title":"Tasks","text":"","category":"section"},{"location":"communication/#","page":"Communication","title":"Communication","text":"The julia webserver is implemented via Julia Tasks. This means that julia code invoked from javascript will run sort of in parallel to your main julia code.","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"In particular:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"Tasks are coroutines, not threads, so they aren't truly running in parallel.\nInstead, execution can switch between your code and the coroutine's code whenever a piece of computation is interruptible.","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"So, if your Blink callback handler performs uninterruptible work, it will fully occupy your CPU, preventing any other computation from occuring, and can potentially hang your computation.","category":"page"},{"location":"communication/#Examples:-1","page":"Communication","title":"Examples:","text":"","category":"section"},{"location":"communication/#","page":"Communication","title":"Communication","text":"BAD: If your callback runs a long loop, it won't be uninterruptible while it's running:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"julia> handle(w, \"press\") do args...\n         println(\"Start\")\n         while true end  # infinite loop\n         println(\"End\")\n       end\n#40 (generic function with 1 method)\n\njulia> body!(w, \"\"\"<button onclick='Blink.msg(\"press\", 1)'>go</button>\"\"\", async=false);\n\njulia> # CLICK THE go BUTTON, AND YOUR PROCESS WILL FREEZE\nStart","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"BAD: The same is true if your main julia computation is hogging the CPU, then your callback can't run:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"julia> handle(w, \"press\") do args...\n         println(\"Start\")\n         sleep(5) # This will happily yield to any other computation.\n         println(\"End\")\n       end\n#41 (generic function with 1 method)\n\njulia> body!(w, \"\"\"<button onclick='Blink.msg(\"press\", 1)'>go</button>\"\"\", async=false);\n\njulia> while true end  # Infinite loop\n\n# NOW, CLICK THE go BUTTON, AND NOTHING HAPPENS, SINCE THE CPU IS BEING HOGGED!","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"GOOD: So to allow for happy communication, all your computations should be interruptible, which you can achieve with calls such as yield, or sleep:","category":"page"},{"location":"communication/#","page":"Communication","title":"Communication","text":"julia> handle(w, \"press\") do args...\n         println(\"Start\")\n         sleep(5) # This will happily yield to any other computation.\n         println(\"End\")\n       end\n#39 (generic function with 1 method)\n\njulia> body!(w, \"\"\"<button onclick='Blink.msg(\"press\", 1)'>go</button>\"\"\", async=false);\n\njulia> while true  # Still an infinite loop, but a _fair_ one.\n         yield()  # This will yield to any other computation, allowing the callback to run.\n       end\n\n# NOW, CLICKING THE go BUTTON WILL WORK CORRECTLY ✅\nStart\nEnd","category":"page"},{"location":"guide/#Usage-Guide-1","page":"Usage Guide","title":"Usage Guide","text":"","category":"section"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"Using Blink to build a local web app has two basic steps:","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"Create a window and load all your HTML and JS.\nHandle interaction between julia and your window.","category":"page"},{"location":"guide/#.-Setting-up-a-new-Blink-Window-1","page":"Usage Guide","title":"1. Setting up a new Blink Window","text":"","category":"section"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"Create a new window via Window, and load some html via body!.","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"julia> using Blink\n\njulia> w = Window(async=false) # Open a new window\nBlink.AtomShell.Window(...)\n\njulia> body!(w, \"Hello World\", async=false) # Set the body content","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"The main functions for setting content on a window are content!(w, querySelector, html) and body!(w, html). body! is just shorthand for content!(w, \"body\", html).","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"You can also load an external url via loadurl, which will replace the current content of the window:","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"loadurl(w, \"http://julialang.org\") # Load a web page","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"Note the use of async=false in the examples above. By default, these functions return immediately, but setting async=false will block until the function has completed. This is important if you are executing multiple statements in a row that depend on the previous statement having completed.","category":"page"},{"location":"guide/#Loading-stadalone-HTML,-CSS-and-JS-files-1","page":"Usage Guide","title":"Loading stadalone HTML, CSS & JS files","text":"","category":"section"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"You can load complete standalone files via the load! function. Blink will handle the file correctly based on its file type suffix:","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"load!(w, \"ui/app.css\")\nload!(w, \"ui/frameworks/jquery-3.3.1.js\")","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"You can also call the corresponding importhtml!, loadcss!, and loadjs! directly.","category":"page"},{"location":"guide/#.-Setting-up-interaction-between-Julia-and-JS-1","page":"Usage Guide","title":"2. Setting up interaction between Julia and JS","text":"","category":"section"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"using Blink\nw = Window(Dict(:show=>false), async=false)","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"This topic is covered in more detail in the Communication page.","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"Just as you can directly write to the DOM via content!, you can directly execute javscript via the @js macro.","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"@js w Math.log(10)","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"To invoke julia code from javascript, you can pass a \"message\" to julia:","category":"page"},{"location":"guide/#","page":"Usage Guide","title":"Usage Guide","text":"# Set up julia to handle the \"press\" message:\nhandle(w, \"press\") do args\n  @show args\nend\n# Invoke the \"press\" message from javascript whenever this button is pressed:\nbody!(w, \"\"\"<button onclick='Blink.msg(\"press\", \"HELLO\")'>go</button>\"\"\");","category":"page"},{"location":"api/#API-1","page":"API","title":"API","text":"","category":"section"},{"location":"api/#Window-1","page":"API","title":"Window","text":"","category":"section"},{"location":"api/#","page":"API","title":"API","text":"Window","category":"page"},{"location":"api/#Blink.AtomShell.Window","page":"API","title":"Blink.AtomShell.Window","text":"Window()\nWindow(electron_options::Dict; async=true)\n\nCreate and open a new Window through Electron.\n\nIf async==false, this function blocks until the Window is fully initialized and ready for you to communicate with it via javascript or the Blink API.\n\nThe electron_options dict is used to initialize the Electron window. See here for the full set of Electron options: https://electronjs.org/docs/api/browser-window#new-browserwindowoptions\n\n\n\n\n\n","category":"type"},{"location":"api/#","page":"API","title":"API","text":"title\nprogress\nflashframe\nactive","category":"page"},{"location":"api/#Blink.AtomShell.title","page":"API","title":"Blink.AtomShell.title","text":"title(win::Window, title)\n\nSet win's title to title.\n\n\n\n\n\ntitle(win::Window)\n\nGet the window's title.\n\n\n\n\n\n","category":"function"},{"location":"api/#Blink.AtomShell.progress","page":"API","title":"Blink.AtomShell.progress","text":"progress(win::Window, p=-1)\n\nSets progress value in progress bar. Valid range is [0, 1.0]. Remove progress bar when progress < 0; Change to indeterminate mode when progress > 1.\n\nhttps://github.com/electron/electron/blob/master/docs/api/browser-window.md#winsetprogressbarprogress-options\n\n\n\n\n\n","category":"function"},{"location":"api/#Blink.AtomShell.flashframe","page":"API","title":"Blink.AtomShell.flashframe","text":"flashframe(win::Window, on=true)\n\nStart or stop \"flashing\" the window to get the user's attention.\n\nIn Windows, flashes the window frame. In MacOS, bounces the app in the Dock. https://github.com/electron/electron/blob/master/docs/api/browser-window.md#winflashframeflag\n\n\n\n\n\n","category":"function"},{"location":"api/#Misc-1","page":"API","title":"Misc","text":"","category":"section"},{"location":"api/#","page":"API","title":"API","text":"opentools\nclosetools\ntools","category":"page"},{"location":"api/#Blink.AtomShell.opentools","page":"API","title":"Blink.AtomShell.opentools","text":"opentools(win::Window)\n\nOpen the Chrome Developer Tools on win.\n\nSee also: closetools, tools\n\n\n\n\n\n","category":"function"},{"location":"api/#Blink.AtomShell.closetools","page":"API","title":"Blink.AtomShell.closetools","text":"closetools(win::Window)\n\nClose the Chrome Developer Tools on win if open.\n\nSee also: opentools, tools\n\n\n\n\n\n","category":"function"},{"location":"api/#Blink.AtomShell.tools","page":"API","title":"Blink.AtomShell.tools","text":"tools(win::Window)\n\nToggle the Chrome Developer Tools on win.\n\nSee also: opentools, closetools\n\n\n\n\n\n","category":"function"},{"location":"api/#RPC-1","page":"API","title":"RPC","text":"","category":"section"},{"location":"api/#","page":"API","title":"API","text":"@js\n@js_\njs\nBlink.JSString","category":"page"},{"location":"api/#JSExpr.@js","page":"API","title":"JSExpr.@js","text":"@js win expr\n\nExecute expr, converted to javascript, inside win, and return the result.\n\nexpr will be parsed as julia code, and then converted directly to the equivalent javascript. Language keywords that don't exist in julia can be represented with their macro equivalents, @var, @new, etc.\n\nSee also: @js_, the asynchronous version.\n\nExamples\n\njulia> @js win x = 5\n5\njulia> @js_ win for i in 1:x console.log(i) end\n\n\n\n\n\n","category":"macro"},{"location":"api/#Blink.@js_","page":"API","title":"Blink.@js_","text":"@js_ win expr\n\nExecute expr, converted to javascript, asynchronously inside win, and return immediately.\n\nexpr will be parsed as julia code, and then converted directly to the equivalent javascript. Language keywords that don't exist in julia can be represented with their macro equivalents, @var, @new, etc.\n\nSee also: @js, the synchronous version that returns its result.\n\nExamples\n\njulia> @js win x = 5\n5\njulia> @js_ win for i in 1:x console.log(i) end\n\n\n\n\n\n","category":"macro"},{"location":"api/#Blink.js","page":"API","title":"Blink.js","text":"js(win, expr::JSString; callback=false)\n\nExecute the javscript in expr, inside win.\n\nIf callback==true, returns the result of evaluating expr.\n\n\n\n\n\n","category":"function"},{"location":"api/#WebIO.JSString","page":"API","title":"WebIO.JSString","text":"JSString(str)\n\nA wrapper around a string indicating the string contains javascript code.\n\n\n\n\n\n","category":"type"},{"location":"#Blink.jl-Documentation-1","page":"Blink.jl Documentation","title":"Blink.jl Documentation","text":"","category":"section"},{"location":"#Overview-1","page":"Blink.jl Documentation","title":"Overview","text":"","category":"section"},{"location":"#","page":"Blink.jl Documentation","title":"Blink.jl Documentation","text":"Blink.jl is the Julia wrapper around Electron. It  can serve HTML content in a local window, and allows for communication between Julia and the web page. In this way, therefore, Blink can be used as a GUI toolkit for building HTML-based applications for the desktop.","category":"page"},{"location":"#Installation-1","page":"Blink.jl Documentation","title":"Installation","text":"","category":"section"},{"location":"#","page":"Blink.jl Documentation","title":"Blink.jl Documentation","text":"To install Blink, run:","category":"page"},{"location":"#","page":"Blink.jl Documentation","title":"Blink.jl Documentation","text":"julia> Pkg.add(\"Blink\")\njulia> Blink.AtomShell.install()","category":"page"},{"location":"#","page":"Blink.jl Documentation","title":"Blink.jl Documentation","text":"This will install the package, and its dependencies: namely, Electron.","category":"page"},{"location":"#Documentation-Outline-1","page":"Blink.jl Documentation","title":"Documentation Outline","text":"","category":"section"},{"location":"#","page":"Blink.jl Documentation","title":"Blink.jl Documentation","text":"","category":"page"}]
}
